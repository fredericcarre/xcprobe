# Scenario D: Logs to stdout only (12-factor)
services:
  host-sim:
    build:
      context: ./host-sim
      dockerfile: Dockerfile
    hostname: test-host-d
    environment:
      NODE_ENV: production
      PORT: "3000"
      DATABASE_URL: "postgresql://app:secret123@db:5432/appdb"
    healthcheck:
      test: ["CMD-SHELL", "node -e \"const h=require('http');h.get('http://localhost:3000/health',r=>{process.exit(r.statusCode===200?0:1)}).on('error',()=>process.exit(1))\""]
      interval: 5s
      timeout: 3s
      retries: 5
